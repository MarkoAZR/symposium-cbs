---
interface FAQItem {
  question: string;
  answer: string;
  id: number;
}

interface Props {
  items: FAQItem[];
}

const { items } = Astro.props;
---

<div class="space-y-4">
  {items.map((item) => (
    <div class="border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 overflow-hidden">
      <button 
        class="w-full px-6 py-4 text-left flex justify-between items-center focus:outline-none hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors"
        onclick={`toggleAccordion(${item.id})`}
      >
        <span class="font-semibold text-slate-900 dark:text-white text-lg">{item.question}</span>
        <span class="material-icons text-slate-400 rotate-icon" id={`icon-${item.id}`}>expand_more</span>
      </button>
      <div 
        class="accordion-content bg-slate-50 dark:bg-slate-800/50 px-6 text-slate-600 dark:text-slate-300 transition-all duration-300" 
        id={`content-${item.id}`}
      >
        <div class="pb-6 pt-2">
          {item.answer}
        </div>
      </div>
    </div>
  ))}
</div>

<script define:vars={{ items }}>
  function toggleAccordion(id) {
    const content = document.getElementById(`content-${id}`);
    const icon = document.getElementById(`icon-${id}`);
    
    // Close other accordions
    const allContents = document.querySelectorAll('.accordion-content');
    const allIcons = document.querySelectorAll('.rotate-icon');
    
    allContents.forEach(c => {
      if (c !== content) {
        c.classList.remove('active');
        c.style.maxHeight = null;
        c.style.opacity = '0';
      }
    });
    
    allIcons.forEach(i => {
      if (i !== icon) {
        i.classList.remove('active');
      }
    });

    // Toggle current
    if (content.classList.contains('active')) {
      content.classList.remove('active');
      content.style.maxHeight = null;
      content.style.opacity = '0';
      icon.classList.remove('active');
    } else {
      content.classList.add('active');
      content.style.maxHeight = content.scrollHeight + 'px';
      content.style.opacity = '1';
      icon.classList.add('active');
    }
  }

  // Expose global function
  window.toggleAccordion = toggleAccordion;
</script>

<style>
  .accordion-content {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
  }

  .rotate-icon {
    transition: transform 0.3s ease;
  }

  .rotate-icon.active {
    transform: rotate(180deg);
  }
</style>
